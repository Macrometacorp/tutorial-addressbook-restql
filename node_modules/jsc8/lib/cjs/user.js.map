{"version":3,"file":"user.js","sourceRoot":"","sources":["../../src/user.ts"],"names":[],"mappings":"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","sourcesContent":["import { Connection } from \"./connection\";\n\nclass User {\n  _connection: Connection;\n  user = \"\";\n\n  urlPrefix: string = \"/_admin/user\";\n\n  constructor(connection: Connection, user: string) {\n    this.user = user;\n    this._connection = connection;\n  }\n\n  createUser(passwd: string = \"\", active: boolean = true, extra: object = {}) {\n    return this._connection.request(\n      {\n        method: \"POST\",\n        path: this.urlPrefix,\n        body: {\n          user: this.user,\n          passwd: passwd,\n          active,\n          extra\n        }\n      },\n      res => res.body\n    );\n  }\n\n  getUserDeatils() {\n    return this._connection.request(\n      {\n        method: \"GET\",\n        path: `/_admin/user/${this.user}`\n      },\n      res => res.body\n    );\n  }\n\n  deleteUser() {\n    return this._connection.request(\n      {\n        method: \"DELETE\",\n        path: `${this.urlPrefix}/${this.user}`\n      },\n      res => res.body\n    );\n  }\n\n  _makeModification(\n    config: { active?: boolean; passwd?: string; extra?: object },\n    methodType: string\n  ) {\n    return this._connection.request(\n      {\n        method: methodType,\n        path: `${this.urlPrefix}/${this.user}`,\n        body: {\n          ...config\n        }\n      },\n      res => res.body\n    );\n  }\n\n  modifyUser(config: { active?: boolean; passwd?: string; extra?: object }) {\n    return this._makeModification(config, \"PATCH\");\n  }\n\n  replaceUser(config: { active?: boolean; passwd: string; extra?: object }) {\n    return this._makeModification(config, \"PUT\");\n  }\n\n  getAllDatabases(isFullRequested: boolean = false) {\n    return this._connection.request(\n      {\n        method: \"GET\",\n        path: `${this.urlPrefix}/${this.user}/database`,\n        qs: {\n          full: isFullRequested\n        }\n      },\n      res => res.body\n    );\n  }\n\n  getDatabaseAccessLevel(databaseName: string) {\n    return this._connection.request(\n      {\n        method: \"GET\",\n        path: `${this.urlPrefix}/${this.user}/database/${databaseName}`\n      },\n      res => res.body\n    );\n  }\n\n  getCollectionAccessLevel(databaseName: string, collectionName: string) {\n    return this._connection.request(\n      {\n        method: \"GET\",\n        path: `${this.urlPrefix}/${\n          this.user\n        }/database/${databaseName}/${collectionName}`\n      },\n      res => res.body\n    );\n  }\n\n  clearDatabaseAccessLevel(fabricName: string) {\n    return this._connection.request(\n      {\n        method: \"DELETE\",\n        path: `${this.urlPrefix}/${this.user}/database/${fabricName}`\n      },\n      res => res.body\n    );\n  }\n\n  setDatabaseAccessLevel(fabricName: string, permission: \"rw\" | \"ro\" | \"none\") {\n    return this._connection.request(\n      {\n        method: \"PUT\",\n        path: `${this.urlPrefix}/${this.user}/database/${fabricName}`,\n        body: {\n          grant: permission\n        }\n      },\n      res => res.body\n    );\n  }\n\n  clearCollectionAccessLevel(fabricName: string, collectionName: string) {\n    return this._connection.request(\n      {\n        method: \"DELETE\",\n        path: `${this.urlPrefix}/${\n          this.user\n        }/database/${fabricName}/${collectionName}`\n      },\n      res => res.body\n    );\n  }\n\n  setCollectionAccessLevel(\n    fabricName: string,\n    collectionName: string,\n    permission: \"rw\" | \"ro\" | \"none\"\n  ) {\n    return this._connection.request(\n      {\n        method: \"PUT\",\n        path: `${this.urlPrefix}/${\n          this.user\n        }/database/${fabricName}/${collectionName}`,\n        body: {\n          grant: permission\n        }\n      },\n      res => res.body\n    );\n  }\n}\n\nexport default User;\n"]}